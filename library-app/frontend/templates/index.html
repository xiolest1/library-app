<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NYPL Library Search</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap">
</head>
<body>
  <!-- Navigation Banner -->
  <nav class="banner">
    <img src="/static/logo.png" alt="Library Logo" class="logo">
    <div class="banner-item">
      <a href="/" style="color: inherit; text-decoration: none;">Home</a>
    </div>
    {% if session.get('user') %}
      <div class="banner-item">
        <a href="/dashboard" style="color: inherit; text-decoration: none;">Dashboard</a>
      </div>
      <div class="banner-item">
        <a href="/logout" style="color: inherit; text-decoration: none;">Logout</a>
      </div>
    {% else %}
      <div class="banner-item">
        <a href="/login" style="color: inherit; text-decoration: none;">Login</a>
      </div>
      <div class="banner-item">
        <a href="/register" style="color: inherit; text-decoration: none;">Register</a>
      </div>
    {% endif %}
    <div class="banner-item">
      <a href="/about" style="color: inherit; text-decoration: none;">About</a>
    </div>
  </nav>

  <!-- Large Image with Overlay Text -->
  <div class="image-container">
    <img src="/static/img0.png" alt="Library Image" class="library-image">
    <div class="overlay-text">Discover. Learn. Explore.</div>
  </div>

  <!-- Main Content: Search Section -->
  <div class="container">
    <h1>NYPL Library Search</h1>
    <div class="search-controls">
      <select id="criteriaSelect">
        <option value="title">Title</option>
        <option value="author">Author</option>
        <option value="subject">Subject</option>
        <option value="isbn">ISBN</option>
      </select>
      <input type="text" id="searchInput" placeholder="Search books...">
    </div>
    <div id="results"></div>
  </div>

  <script>
    const criteriaSelect = document.getElementById('criteriaSelect');
    const searchInput = document.getElementById('searchInput');
    const resultsDiv = document.getElementById('results');

    // Real-time search using the original functionality (with cover images)
    searchInput.addEventListener('input', async (e) => {
      const query = e.target.value.trim();
      const criteria = criteriaSelect.value;
      if (query.length > 0) {
        const response = await fetch(`/search?q=${encodeURIComponent(query)}&criteria=${encodeURIComponent(criteria)}`);
        const books = await response.json();
        displayResults(books);
      } else {
        resultsDiv.innerHTML = '';
      }
    });

    function displayResults(books) {
      resultsDiv.className = 'results-grid';
      resultsDiv.innerHTML = books.map(book => {
        const coverUrl = book.cover_i
          ? `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg`
          : 'https://via.placeholder.com/128x192?text=No+Cover';
        return `
          <div class="book">
            <img src="${coverUrl}" alt="Book Cover" class="book-cover">
            <div>
              <h3>${book.title}</h3>
              <p>Author: ${book.author}</p>
              ${book.year ? `<p>Year: ${book.year}</p>` : ''}
            </div>
          </div>
        `;
      }).join('');
    }
  </script>
</body>
</html>
